---
title: Avoiding namespace pollution in R and Chez Scheme
author: Travis Hinkelman
date: '2020-02-19'
slug: avoiding-namespace-pollution-in-r-and-chez-scheme
categories:
  - R
  - ChezScheme
tags:
  - packages
  - libraries
  - namespaces
draft: false
---



<p>I was reading a <a href="https://white.ucc.asn.au/2020/02/09/whycompositionaljulia.html">blog post</a> that mentioned that Julia has “[w]eak conventions about namespace pollution” and it got me thinking about how I manage namespace pollution in R and Chez Scheme. The short answer is that I don’t. I developed bad habits in R centered around writing overly terse code. These habits emerged in a pre-RStudio, pre-dplyr world where I wasn’t using autocomplete and disliked long data frame and function names. For example, I strongly preferred writing</p>
<pre><code>&gt; df$CS &lt;- cumsum(df$Ttl)</code></pre>
<p>over</p>
<pre><code>&gt; fish_counts$CountTotal_CumSum &lt;- cumsum(fish_counts$CountTotal)</code></pre>
<p>My R code was littered with acronyms that made sense when I was writing the code, but were hard to decipher when I came back to it later. Essentially, I was producing <a href="https://en.wikipedia.org/wiki/Write-only_language">write-only code</a>. Because I was usually writing short, one-off scripts that were infrequently revisited, I rarely felt the type of pain that this style can inflict.</p>
<p>I am a heavy user of 3rd-party packages for R, but my preference for terseness meant that I tended to put all of my <code>library</code> calls at the top of the script and re-arrange the order that packages were loaded to manage namespace conflicts.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> Honestly, I only today learned that <code>library</code> has arguments (<code>exclude</code> and <code>include.only</code>) for managing the objects that are attached. Because it inevitably leads to more verbose code, I also rarely used <code>::</code> (e.g., <code>dplyr::filter</code>) to unambigously specify which version of a function that I wanted to use.</p>
<p>I don’t profess to have a strong understanding of namespace best practices. Nonetheless, my current understanding is that generally it is a good practice to only load the functions that you are using from a package. In interactive use, though, I don’t think that you want to impede your programming flow by constraining the functions immediately available to you. <code>ggplot2</code> comes to mind here as a case where you are better off loading the full package functionality.</p>
<p>When you are using only one function from a package, you might opt for <code>::</code> if you only call that function once or twice and <code>include.only</code> if you call the function many times in a script. For me, <code>MESS::auc</code> is an example where I have typically used the <code>::</code> operator because I want the reminder that <code>auc</code> is found in the <code>MESS</code> packge. Alternatively, I could use <code>library(MESS, include.only = c(&quot;auc&quot;))</code>.</p>
<p>The approach for importing libraries in Chez Scheme is similar to loading packages in R. To load all the functions in my <a href="https://github.com/hinkelman/chez-stats"><code>chez-stats</code> library</a>, you use <code>(import (chez-stats chez-stats))</code><a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> We can import only the <code>mean</code> and <code>median</code> procedures with</p>
<pre><code>&gt; (import (only (chez-stats chez-stats) mean median))</code></pre>
<p>We can also reduce the potential for namespace conflicts by importing a library with a prefix.</p>
<pre><code>&gt; (import (prefix (chez-stats chez-stats) cs:))
&gt; (cs:mean &#39;(1 2 2 3 3 3 4 4 4 4))
3</code></pre>
<p>My preliminary experience of using the prefix approach greatly improved my autocompletion experience in Emacs. Similarly, a <a href="https://community.rstudio.com/t/function-naming-conventions-and-best-practice/3381">discussion of function naming conventions in R packages</a> was largely centered on how function prefixes pair nicely with autocompletion in making an R package friendly to new users.</p>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>I am aware that the <a href="https://conflicted.r-lib.org"><code>conflicted</code> package</a> offers a stricter way to handle namespace conflicts but I have not tried it.<a href="#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p><code>chez-stats</code> is an umbrella library and a first step towards constraining the imported procedures is to only import one of the constituent libraries, e.g., <code>(import (chez-stats statistics))</code>.<a href="#fnref2" class="footnote-back">↩</a></p></li>
</ol>
</div>
